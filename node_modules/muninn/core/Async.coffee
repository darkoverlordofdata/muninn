#+--------------------------------------------------------------------+
#| Async.coffee
#+--------------------------------------------------------------------+
#| Copyright DarkOverlordOfData (c) 2014
#+--------------------------------------------------------------------+
#|
#| This file is a part of Muninn
#|
#| Muninn is free software; you can copy, modify, and distribute
#| it under the terms of the MIT License
#|
#+--------------------------------------------------------------------+
#
#	Class Async
#
async = require('async')

class muninn.core.Object

  #
  # Async job queue for the controller
  #
  # @param  [Function]  fn  Function to push onto the queue
  # @return	[Void]
  #
  queue: ($fn) ->

    @_queue = [] unless @_queue?
    if $fn then @_queue.push($fn) else @_queue

  #
  # Run the functions in the queue
  #
  # @param  [Function]  next  async callback
  # @return [Void]
  #
  run: ($next) ->

    @_queue = [] unless @_queue?
    async.series @_queue, ($err, $results) =>
      @_queue = []
      return $next($err)

module.exports = muninn.core.Object

